/**
 * é—¯å…³æ¨¡å¼ç±»å‹å®šä¹‰
 * HydroQuiz - æ°´åˆ©å·¥ç¨‹æ£€æµ‹å‘˜åˆ·é¢˜å®
 */

/**
 * éš¾åº¦ç±»å‹
 */
export type GameDifficulty = 'easy' | 'medium' | 'hard' | 'boss';

/**
 * å…³å¡æ•°æ®æ¨¡å‹
 */
export interface GameLevel {
  id: string;
  chapterId: string;
  levelNumber: number;
  name: string;
  description: string;
  questionCount: number;
  difficulty: GameDifficulty;
  requiredStars: number;      // è§£é”æ‰€éœ€æ˜Ÿæ˜Ÿæ•°
  isUnlocked: boolean;
  bestStars: number;          // æœ€ä½³æˆç»© (0-3)
  bestScore: number;          // æœ€ä½³åˆ†æ•°
  completedTimes: number;     // å®Œæˆæ¬¡æ•°
}

/**
 * ç« èŠ‚æ•°æ®æ¨¡å‹
 */
export interface GameChapter {
  id: string;
  subjectId: string;
  name: string;
  shortName: string;
  icon: string;
  color: string;
  levels: GameLevel[];
  totalStars: number;         // æ€»æ˜Ÿæ˜Ÿæ•°
  earnedStars: number;        // å·²è·å¾—æ˜Ÿæ˜Ÿæ•°
  isUnlocked: boolean;
  order: number;
}

/**
 * é—¯å…³è¿›åº¦è®°å½•
 */
export interface GameProgress {
  id: string;
  chapterId: string;
  levelId: string;
  bestStars: number;
  bestScore: number;
  completedTimes: number;
  lastPlayTime: number;
}

/**
 * é—¯å…³ç»“æœ
 */
export interface GameResult {
  levelId: string;
  chapterId: string;
  totalQuestions: number;
  correctCount: number;
  wrongCount: number;
  accuracy: number;
  stars: number;
  score: number;
  earnedPoints: number;
  isNewRecord: boolean;
  duration: number;
}

/**
 * éš¾åº¦é…ç½®é¡¹æ¥å£
 */
export interface DifficultyConfigItem {
  name: string;
  color: string;
  icon: string;
}

/**
 * è·å–éš¾åº¦é…ç½®
 */
export function getDifficultyConfig(difficulty: GameDifficulty): DifficultyConfigItem {
  switch (difficulty) {
    case 'easy':
      return { name: 'ç®€å•', color: '#52C41A', icon: 'ğŸŒ±' };
    case 'medium':
      return { name: 'ä¸­ç­‰', color: '#FAAD14', icon: 'ğŸ”¥' };
    case 'hard':
      return { name: 'å›°éš¾', color: '#FF4D4F', icon: 'ğŸ’ª' };
    case 'boss':
      return { name: 'Boss', color: '#722ED1', icon: 'ğŸ‘‘' };
    default:
      return { name: 'ç®€å•', color: '#52C41A', icon: 'ğŸŒ±' };
  }
}

/**
 * æ ¹æ®æ­£ç¡®ç‡è®¡ç®—æ˜Ÿçº§
 */
export function calculateStars(accuracy: number): number {
  if (accuracy >= 100) return 3;
  if (accuracy >= 80) return 2;
  if (accuracy >= 60) return 1;
  return 0;
}

/**
 * æ ¹æ®æ˜Ÿçº§è®¡ç®—ç§¯åˆ†
 */
export function calculateLevelPoints(stars: number): number {
  switch (stars) {
    case 3: return 30;
    case 2: return 20;
    case 1: return 10;
    default: return 0;
  }
}
